packaging_format = 2

id = "gitlab"
name = "GitLab"
description.en = "Git-repository manager providing wiki, issue-tracking and CI/CD pipeline features"
description.fr = "Gestionnaire de dépôts Git proposant des fonctionnalités de wiki, suivi de bugs et de pipeline CI/CD"

version = "18.6.0~ynh1"

maintainers = ["kay0u"]

[upstream]
license = "MIT"
website = "https://gitlab.com"
demo = "https://gitlab.com/explore"
admindoc = "https://docs.gitlab.com/"
code = "https://gitlab.com/gitlab-org/gitlab"
cpe = "cpe:2.3:a:gitlab:gitlab"

[integration]
yunohost = ">= 12.0.9"
helpers_version = "2.1"
architectures = ["amd64", "arm64"]
multi_instance = false

ldap = true
sso = false

disk = "500M"
ram.build = "3000M"
ram.runtime = "2000M"

[install]
    [install.domain]
    type = "domain"

    [install.path]
    type = "path"
    default = "/gitlab"

    [install.admin]
    type = "user"

    [install.init_main_permission]
    help.en = "If your GitLab instance is set to visitors, anyone can see your public repositories."
    help.fr = "Si votre instance GitLab est définie sur visiteurs, tout le monde pourra voir vos dépôts publics."
    type = "group"
    default = "visitors"

    [install.use_web_account]
    ask.en = "Authorize account creation from GitLab web interface"
    ask.fr = "Autoriser la création de compte depuis l'interface web de GitLab ?"
    type = "boolean"
    default = false

[resources]
    [resources.system_user]

    [resources.install_dir]
    dir = "/opt/__APP__"
    owner = "root:rwx"
    group = "root:rx"

    [resources.permissions]
    main.url = "/"
    # Fix #264 and #267
    main.auth_header = false

    [resources.ports]
    main.default = 8080
    puma.default = 8081
    sidekiq.default = 8082

    [resources.apt]
    packages = "openssh-server"

    [resources.sources]
        [resources.sources.latest_bookworm]
            extract = false
            rename = "gitlab-ce.deb"
            amd64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bookworm/gitlab-ce_18.6.0-ce.0_amd64.deb/download.deb"
            amd64.sha256 = "a92b0d3197e73b309a12d5a5ca12d66369d51111329692bcb8b531580d343f50"
            arm64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bookworm/gitlab-ce_18.6.0-ce.0_arm64.deb/download.deb"
            arm64.sha256 = "ccbe30326a1783887b97bce0d870a903f254880007ab632f3f2454d3b6983413"

        [resources.sources.latest_bullseye]
            extract = false
            rename = "gitlab-ce.deb"
            amd64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bullseye/gitlab-ce_18.6.0-ce.0_amd64.deb/download.deb"
            amd64.sha256 = "c1b40bc392d763f6333db43ae23ff2946782ffe217fa46fb5134960bd4d76e4a"
            arm64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bullseye/gitlab-ce_18.6.0-ce.0_arm64.deb/download.deb"
            arm64.sha256 = "c249801e14c4bfc26f15ecbf36d88aeaab10cb826b88439685c626d1ff4bae7d"

        [resources.sources.latest_trixie]
            extract = false
            rename = "gitlab-ce.deb"
            amd64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/trixie/gitlab-ce_18.6.0-ce.0_amd64.deb/download.deb"
            amd64.sha256 = "8380abd940dbb3da1475de24bfa9e292fa769de3a14017b133c76c7a09d29715"
            arm64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/trixie/gitlab-ce_18.6.0-ce.0_arm64.deb/download.deb"
            arm64.sha256 = "9c8615259c808334d8d612f7d70104f380274e98613a7056e3204c57e713e120"

        # GitLab 18.5.2
        [resources.sources.v18_5_2_bullseye]
            prefetch = false
            extract = false
            rename = "gitlab-ce.deb"
            amd64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bullseye/gitlab-ce_18.5.2-ce.0_amd64.deb/download.deb"
            amd64.sha256 = "3adf44daee91c5e89bd20e74b79098ad2ecc43d73dd6ea0e0fbdf3edeeb8a72b"
            arm64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bullseye/gitlab-ce_18.5.2-ce.0_arm64.deb/download.deb"
            arm64.sha256 = "7521c6a3efe88a03a3cfa9ff6954dc08b6316ea10c1280f8d88a5e653a29b292"

        [resources.sources.v18_5_2_bookworm]
            prefetch = false
            extract = false
            rename = "gitlab-ce.deb"
            amd64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bookworm/gitlab-ce_18.5.2-ce.0_amd64.deb/download.deb"
            amd64.sha256 = "02af2d2bdc87828b99ddd45b209b4769cfef7a99df1cb33c8a51390d43c4c372"
            arm64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bookworm/gitlab-ce_18.5.2-ce.0_arm64.deb/download.deb"
            arm64.sha256 = "6b8888aa2d2a17b77d1a7e452fb95bb45bc7bb42b49ded96dc9c335fce581806"

        [resources.sources.v18_5_2_trixie]
            prefetch = false
            extract = false
            rename = "gitlab-ce.deb"
            amd64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/trixie/gitlab-ce_18.5.2-ce.0_amd64.deb/download.deb"
            amd64.sha256 = "292fd2553d7282bb1d9f996f4d824f52136d21bd9dcb2cac568b53dbc2dcad0c"
            arm64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/trixie/gitlab-ce_18.5.2-ce.0_arm64.deb/download.deb"
            arm64.sha256 = "9ca5c0c76e8f3ad87e190133f018c1e3d3497f067caf2057e745da3e8a50f3fc"

        # GitLab 18.2.8
        [resources.sources.v18_2_8_bullseye]
            prefetch = false
            extract = false
            rename = "gitlab-ce.deb"
            amd64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bullseye/gitlab-ce_18.2.8-ce.0_amd64.deb/download.deb"
            amd64.sha256 = "12113a6681b54475eba340d383f618485fc96285ae8480db8ac57b476b62fc2b"
            arm64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bullseye/gitlab-ce_18.2.8-ce.0_arm64.deb/download.deb"
            arm64.sha256 = "a8e861a3c635c15698367561b0397e5a175a0c06fe333be9af6ff73ea3d8dfd4"

        [resources.sources.v18_2_8_bookworm]
            prefetch = false
            extract = false
            rename = "gitlab-ce.deb"
            amd64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bookworm/gitlab-ce_18.2.8-ce.0_amd64.deb/download.deb"
            amd64.sha256 = "417da6fb09c1c4bc46123d9aac564bc6f10faf8e1cfa50e6bb9fe54ec9e8b111"
            arm64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bookworm/gitlab-ce_18.2.8-ce.0_arm64.deb/download.deb"
            arm64.sha256 = "47340403d3052a96d96312552287982f827b69435bb5c846ee154fee4706a78d"

        # GitLab 17.11.7
        [resources.sources.v17_11_7_bullseye]
            prefetch = false
            extract = false
            rename = "gitlab-ce.deb"
            amd64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bullseye/gitlab-ce_17.11.7-ce.0_amd64.deb/download.deb"
            amd64.sha256 = "ab220bf229c521fe7c3896df9b29affa13104296d087c33fd662090de82e7af7"
            arm64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bullseye/gitlab-ce_17.11.7-ce.0_arm64.deb/download.deb"
            arm64.sha256 = "cee043aec23d520731dddfadf784a70171064e351ededa64ced966959491723e"

        [resources.sources.v17_11_7_bookworm]
            prefetch = false
            extract = false
            rename = "gitlab-ce.deb"
            amd64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bookworm/gitlab-ce_17.11.7-ce.0_amd64.deb/download.deb"
            amd64.sha256 = "8579324f987f5539743e01a12a062d798c2b03f177cfc85fed3cb7c7f2e80822"
            arm64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bookworm/gitlab-ce_17.11.7-ce.0_arm64.deb/download.deb"
            arm64.sha256 = "c37707697a3313c5ed58c90152bbe286e94bb15e7925e23fc703062f1bb78df9"

        # GitLab 17.8.7
        [resources.sources.v17_8_7_bullseye]
            prefetch = false
            extract = false
            rename = "gitlab-ce.deb"
            amd64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bullseye/gitlab-ce_17.8.7-ce.0_amd64.deb/download.deb"
            amd64.sha256 = "f89b639420a28a4249a82f0ba56d244dbc8e6a6df3f06c6e44c86ee366222e99"
            arm64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bullseye/gitlab-ce_17.8.7-ce.0_arm64.deb/download.deb"
            arm64.sha256 = "9190058d823f2295ed4632cb5fa2227e128e354254d80500838d10635e4bd704"

        [resources.sources.v17_8_7_bookworm]
            prefetch = false
            extract = false
            rename = "gitlab-ce.deb"
            amd64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bookworm/gitlab-ce_17.8.7-ce.0_amd64.deb/download.deb"
            amd64.sha256 = "b79063815bbf25f6461c55614f8ca1c2addc5f2b1a5dc6f8935d6af678c2f892"
            arm64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bookworm/gitlab-ce_17.8.7-ce.0_arm64.deb/download.deb"
            arm64.sha256 = "851d75bbc1f60d3e6a22d0e7f2f3135ae0dcac4d44a32edab30ca9607a6df6ad"

        # GitLab 17.5.5
        [resources.sources.v17_5_5_bullseye]
            prefetch = false
            extract = false
            rename = "gitlab-ce.deb"
            amd64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bullseye/gitlab-ce_17.5.5-ce.0_amd64.deb/download.deb"
            amd64.sha256 = "b0f40eb8a2d55634cff59125304df1fa1fda1601dec1bf3547a4351aabd81221"
            arm64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bullseye/gitlab-ce_17.5.5-ce.0_arm64.deb/download.deb"
            arm64.sha256 = "8b9e8722e064889f9e20f781e61356ce8035cec5fe4cbe255b6aba97e7a7067c"

        [resources.sources.v17_5_5_bookworm]
            prefetch = false
            extract = false
            rename = "gitlab-ce.deb"
            amd64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bookworm/gitlab-ce_17.5.5-ce.0_amd64.deb/download.deb"
            amd64.sha256 = "cce4ebff28a0b76152922b09a2cb67fd4bc0cfdff22185654135bb93ce658bcf"
            arm64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bookworm/gitlab-ce_17.5.5-ce.0_arm64.deb/download.deb"
            arm64.sha256 = "51c8ca34a1c2d24b209b74f6f5dbf4e446d61cbe85de51f56c010e116c2468b3"

        # GitLab 17.3.7
        [resources.sources.v17_3_7_bullseye]
            prefetch = false
            extract = false
            rename = "gitlab-ce.deb"
            amd64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bullseye/gitlab-ce_17.3.7-ce.0_amd64.deb/download.deb"
            amd64.sha256 = "e78c276952c6202c23b9baac8afe05ebcaf1c5f2639e51865157e5ebddbb9554"
            arm64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bullseye/gitlab-ce_17.3.7-ce.0_arm64.deb/download.deb"
            arm64.sha256 = "f22a39ea10275d7be6b0abe02728ae92f99afdcce2220d1d6cf802332375b1f8"

        [resources.sources.v17_3_7_bookworm]
            prefetch = false
            extract = false
            rename = "gitlab-ce.deb"
            amd64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bookworm/gitlab-ce_17.3.7-ce.0_amd64.deb/download.deb"
            amd64.sha256 = "26ad3fd4533e648d8a0e393ef95c761da486aca6d84295c8ba99d0ee6afa989e"
            arm64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bookworm/gitlab-ce_17.3.7-ce.0_arm64.deb/download.deb"
            arm64.sha256 = "7fc3fc2b589f7f270f04d03bf0286d0b271f33346f521dc1174ced9d9b4d2561"

        # GitLab 17.1.8
        [resources.sources.v17_1_8_bullseye]
            prefetch = false
            extract = false
            rename = "gitlab-ce.deb"
            amd64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bullseye/gitlab-ce_17.1.8-ce.0_amd64.deb/download.deb"
            amd64.sha256 = "4aeefcae5fc886a83a5bca02f96b9ea15390d19f3dd5e60f43971d8e373830b3"
            arm64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bullseye/gitlab-ce_17.1.8-ce.0_arm64.deb/download.deb"
            arm64.sha256 = "fbbcad2475101deb46c2bdba3cf5cac01ac0816b23f0e1dea682912ce85d5b30"

        [resources.sources.v17_1_8_bookworm]
            prefetch = false
            extract = false
            rename = "gitlab-ce.deb"
            amd64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bookworm/gitlab-ce_17.1.8-ce.0_amd64.deb/download.deb"
            amd64.sha256 = "6a0c4466d43692491d3bd63a66f411ede7114ed73cc0d71649c0def1d1768e6b"
            arm64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bookworm/gitlab-ce_17.1.8-ce.0_arm64.deb/download.deb"
            arm64.sha256 = "64d92f60b00079f40f62dd5248e1bc6a1da0938b0e6fb22c921c4907e93b8b9c"

        # GitLab 16.11.10
        [resources.sources.v16_11_10_bullseye]
            prefetch = false
            extract = false
            rename = "gitlab-ce.deb"
            amd64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bullseye/gitlab-ce_16.11.10-ce.0_amd64.deb/download.deb"
            amd64.sha256 = "f069370fd9d8a893a628a66a1ea4e4d857440ab0fea43d289d2177182b65e0da"
            arm64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bullseye/gitlab-ce_16.11.10-ce.0_arm64.deb/download.deb"
            arm64.sha256 = "3da28c1d1d4f88e39bfc546a621aee984f5a90072f3dd8756587fa7b9c70aa40"

        [resources.sources.v16_11_10_bookworm]
            prefetch = false
            extract = false
            rename = "gitlab-ce.deb"
            amd64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bookworm/gitlab-ce_16.11.10-ce.0_amd64.deb/download.deb"
            amd64.sha256 = "4312fe0d2be18beaf3af927ed6e34cb5a4048275315c5415922adc600650c52f"
            arm64.url = "https://packages.gitlab.com/gitlab/gitlab-ce/packages/debian/bookworm/gitlab-ce_16.11.10-ce.0_arm64.deb/download.deb"
            arm64.sha256 = "5bc3c67dad538665ba11269fc7d1eb21234171822381f11d0d17b242fe5c8067"


